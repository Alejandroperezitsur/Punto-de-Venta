import{c as j,r as s,d as e,B as m,X as U,P as k,C as f,I as g,T as I,e as c,l as A}from"./index-DpaXIdRB.js";import{C as L}from"./check-DpoXrHyr.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],T=j("pen",P),q=()=>{const[p,x]=s.useState([]),[b,h]=s.useState(!0),[o,i]=s.useState(!1),[r,d]=s.useState(null),[t,l]=s.useState({username:"",password:"",role:"cajero"}),[v,E]=s.useState(!1),u=async()=>{h(!0);try{const a=await c("/auth/users");x(a)}catch(a){console.error(a)}finally{h(!1)}};s.useEffect(()=>{u()},[]);const N=async a=>{if(a.preventDefault(),!t.username||!r&&!t.password){alert("Complete todos los campos requeridos");return}E(!0);try{r?await c(`/auth/users/${r}`,{method:"PUT",body:JSON.stringify({role:t.role,password:t.password||void 0})}):await c("/auth/users",{method:"POST",body:JSON.stringify(t)}),l({username:"",password:"",role:"cajero"}),d(null),i(!1),await u()}catch(n){alert("Error: "+n.message)}finally{E(!1)}},y=a=>{l({username:a.username,password:"",role:a.role}),d(a.id),i(!0)},w=async a=>{if(window.confirm("¿Eliminar este usuario?"))try{await c(`/auth/users/${a}`,{method:"DELETE"}),await u()}catch(n){alert("Error: "+n.message)}},C=a=>{const n={admin:"bg-red-100 text-red-700 border-red-200",supervisor:"bg-blue-100 text-blue-700 border-blue-200",cajero:"bg-green-100 text-green-700 border-green-200"},S={admin:"Administrador",supervisor:"Supervisor",cajero:"Cajero"};return e.createElement("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-semibold rounded-full border ${n[a]||"bg-gray-100"}`},e.createElement(A,{className:"h-3 w-3"}),S[a]||a)};return e.createElement("div",{className:"space-y-6 max-w-4xl mx-auto"},e.createElement("div",{className:"flex justify-between items-center"},e.createElement("h1",{className:"text-2xl font-bold"},"Gestión de Usuarios"),e.createElement(m,{onClick:()=>{i(!o),d(null),l({username:"",password:"",role:"cajero"})}},o?e.createElement(U,{className:"h-4 w-4 mr-2"}):e.createElement(k,{className:"h-4 w-4 mr-2"}),o?"Cancelar":"Nuevo Usuario")),o&&e.createElement(f,{className:"p-6 animate-fade-in border-l-4 border-l-[hsl(var(--primary))]"},e.createElement("h3",{className:"font-semibold mb-4"},r?"Editar Usuario":"Crear Nuevo Usuario"),e.createElement("form",{onSubmit:N,className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end"},e.createElement("div",null,e.createElement("label",{className:"text-xs font-medium mb-1 block"},"Usuario"),e.createElement(g,{placeholder:"nombre_usuario",value:t.username,onChange:a=>l({...t,username:a.target.value}),disabled:!!r,required:!r})),e.createElement("div",null,e.createElement("label",{className:"text-xs font-medium mb-1 block"},"Contraseña ",r&&"(dejar vacío para no cambiar)"),e.createElement(g,{type:"password",placeholder:r?"••••••••":"Contraseña",value:t.password,onChange:a=>l({...t,password:a.target.value}),required:!r})),e.createElement("div",null,e.createElement("label",{className:"text-xs font-medium mb-1 block"},"Rol"),e.createElement("select",{className:"flex h-10 w-full rounded-md border border-[hsl(var(--border))] bg-white px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[hsl(var(--primary))]",value:t.role,onChange:a=>l({...t,role:a.target.value})},e.createElement("option",{value:"cajero"},"Cajero"),e.createElement("option",{value:"supervisor"},"Supervisor"),e.createElement("option",{value:"admin"},"Administrador"))),e.createElement(m,{type:"submit",isLoading:v},e.createElement(L,{className:"h-4 w-4 mr-2"}),r?"Guardar Cambios":"Crear Usuario"))),e.createElement(f,{className:"p-0 overflow-hidden"},b?e.createElement("div",{className:"p-8 text-center text-[hsl(var(--muted-foreground))]"},"Cargando usuarios..."):p.length===0?e.createElement("div",{className:"p-8 text-center text-[hsl(var(--muted-foreground))]"},"No hay usuarios"):e.createElement("table",{className:"w-full text-sm"},e.createElement("thead",{className:"bg-[hsl(var(--muted))]"},e.createElement("tr",null,e.createElement("th",{className:"text-left px-6 py-3 font-medium"},"Usuario"),e.createElement("th",{className:"text-left px-6 py-3 font-medium"},"Rol"),e.createElement("th",{className:"text-left px-6 py-3 font-medium"},"Estado"),e.createElement("th",{className:"text-right px-6 py-3 font-medium"},"Acciones"))),e.createElement("tbody",{className:"divide-y divide-[hsl(var(--border))]"},p.map(a=>e.createElement("tr",{key:a.id,className:"hover:bg-[hsl(var(--muted))/0.5]"},e.createElement("td",{className:"px-6 py-4"},e.createElement("div",{className:"flex items-center gap-3"},e.createElement("div",{className:"h-8 w-8 rounded-full bg-gradient-to-r from-[hsl(var(--primary))] to-blue-600 flex items-center justify-center text-white font-bold text-sm"},a.username.charAt(0).toUpperCase()),e.createElement("span",{className:"font-medium"},a.username))),e.createElement("td",{className:"px-6 py-4"},C(a.role)),e.createElement("td",{className:"px-6 py-4"},e.createElement("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium rounded-full ${a.active!==0?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"}`},a.active!==0?"Activo":"Inactivo")),e.createElement("td",{className:"px-6 py-4 text-right"},e.createElement("div",{className:"flex justify-end gap-2"},e.createElement(m,{variant:"ghost",size:"icon",onClick:()=>y(a),className:"h-8 w-8"},e.createElement(T,{className:"h-4 w-4"})),a.username!=="admin"&&e.createElement(m,{variant:"ghost",size:"icon",onClick:()=>w(a.id),className:"h-8 w-8 text-red-500 hover:bg-red-50"},e.createElement(I,{className:"h-4 w-4"}))))))))))};export{q as default};
