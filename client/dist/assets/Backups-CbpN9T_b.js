import{c as E,r,d as e,B as l,P as v,C as d,v as w,T as k,e as n}from"./index-DJpstOmH.js";import{D as b}from"./download-k-o8J6Xn.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],x=E("hard-drive",C);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],S=E("rotate-ccw",B),T=a=>{if(a===0)return"0 B";const c=1024,o=["B","KB","MB","GB"],s=Math.floor(Math.log(a)/Math.log(c));return parseFloat((a/Math.pow(c,s)).toFixed(1))+" "+o[s]},A=()=>{const[a,c]=r.useState([]),[o,s]=r.useState(!0),[f,u]=r.useState(!1),[h,p]=r.useState(null),m=async()=>{s(!0);try{const t=await n("/system/backups");c(t)}catch(t){console.error(t)}finally{s(!1)}};r.useEffect(()=>{m()},[]);const y=async()=>{u(!0);try{await n("/system/backups",{method:"POST"}),await m()}catch(t){alert("Error al crear backup: "+t.message)}finally{u(!1)}},g=async t=>{if(window.confirm("¿Eliminar este backup? Esta acción no se puede deshacer."))try{await n(`/system/backups/${t}`,{method:"DELETE"}),await m()}catch(i){alert("Error: "+i.message)}},N=async t=>{if(window.confirm("⚠️ ADVERTENCIA: Esto reemplazará TODOS los datos actuales con el backup seleccionado. ¿Continuar?")&&window.confirm("¿Está SEGURO? Se creará un backup de seguridad automático.")){p(t);try{await n(`/system/backups/${t}/restore`,{method:"POST"}),alert("✅ Backup restaurado correctamente. Por favor, recarga la aplicación."),window.location.reload()}catch(i){alert("Error: "+i.message)}finally{p(null)}}};return e.createElement("div",{className:"space-y-6 max-w-4xl mx-auto"},e.createElement("div",{className:"flex justify-between items-center"},e.createElement("div",{className:"flex items-center gap-3"},e.createElement(x,{className:"h-6 w-6 text-[hsl(var(--primary))]"}),e.createElement("h1",{className:"text-2xl font-bold"},"Respaldos del Sistema")),e.createElement(l,{onClick:y,isLoading:f},e.createElement(v,{className:"h-4 w-4 mr-2"}),"Crear Backup")),e.createElement(d,{className:"p-4 bg-amber-50 border-amber-200 flex items-start gap-3"},e.createElement(w,{className:"h-5 w-5 text-amber-600 mt-0.5"}),e.createElement("div",{className:"text-sm text-amber-800"},e.createElement("p",{className:"font-semibold"},"Importante"),e.createElement("p",null,"Los backups contienen TODA la información del sistema: productos, ventas, clientes, configuración y usuarios."))),e.createElement(d,{className:"p-6"},e.createElement("h3",{className:"font-semibold mb-4"},"Exportar / Importar Configuración"),e.createElement("div",{className:"flex gap-4"},e.createElement(l,{variant:"outline",onClick:()=>window.open("/api/system/export-config","_blank")},e.createElement(b,{className:"h-4 w-4 mr-2"}),"Exportar Configuración")),e.createElement("p",{className:"text-xs text-[hsl(var(--muted-foreground))] mt-2"},"Exporta solo la configuración del sistema (sin datos de ventas ni productos).")),e.createElement(d,{className:"p-0 overflow-hidden"},o?e.createElement("div",{className:"p-8 text-center text-[hsl(var(--muted-foreground))]"},"Cargando backups..."):a.length===0?e.createElement("div",{className:"p-12 text-center"},e.createElement(x,{className:"h-12 w-12 mx-auto text-[hsl(var(--muted-foreground))] opacity-50 mb-4"}),e.createElement("p",{className:"text-[hsl(var(--muted-foreground))]"},"No hay backups disponibles"),e.createElement("p",{className:"text-sm text-[hsl(var(--muted-foreground))]"},"Crea tu primer backup para proteger tus datos")):e.createElement("table",{className:"w-full text-sm"},e.createElement("thead",{className:"bg-[hsl(var(--muted))]"},e.createElement("tr",null,e.createElement("th",{className:"text-left px-6 py-3 font-medium"},"Archivo"),e.createElement("th",{className:"text-left px-6 py-3 font-medium"},"Tipo"),e.createElement("th",{className:"text-left px-6 py-3 font-medium"},"Tamaño"),e.createElement("th",{className:"text-left px-6 py-3 font-medium"},"Fecha"),e.createElement("th",{className:"text-right px-6 py-3 font-medium"},"Acciones"))),e.createElement("tbody",{className:"divide-y divide-[hsl(var(--border))]"},a.map(t=>e.createElement("tr",{key:t.id,className:"hover:bg-[hsl(var(--muted))/0.5]"},e.createElement("td",{className:"px-6 py-4 font-mono text-xs"},t.filename),e.createElement("td",{className:"px-6 py-4"},e.createElement("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${t.type==="manual"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`},t.type==="manual"?"Manual":"Automático")),e.createElement("td",{className:"px-6 py-4 text-[hsl(var(--muted-foreground))]"},T(t.size)),e.createElement("td",{className:"px-6 py-4 text-[hsl(var(--muted-foreground))]"},new Date(t.created_at).toLocaleString()),e.createElement("td",{className:"px-6 py-4"},e.createElement("div",{className:"flex justify-end gap-2"},e.createElement(l,{variant:"ghost",size:"icon",className:"h-8 w-8 text-green-600",onClick:()=>N(t.id),isLoading:h===t.id,title:"Restaurar"},e.createElement(S,{className:"h-4 w-4"})),e.createElement(l,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-500",onClick:()=>g(t.id),title:"Eliminar"},e.createElement(k,{className:"h-4 w-4"}))))))))))};export{A as default};
